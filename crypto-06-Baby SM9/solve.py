from Crypto.Util.number import long_to_bytes, bytes_to_long
import hashlib


K = 2048


def H2(x):
    ans = b''
    b = long_to_bytes(x, K // 8)
    now = 0
    while now * 8 < K:
        ans += hashlib.sha512(b[now:min(now+64, len(b)-1)]).digest()
        now = len(ans)
    return ans[:K]


def decrypt(c, d_ID, N):
    U, V = c
    m = long_to_bytes(V ^ bytes_to_long(H2(pow(U, d_ID, N))))
    return m


if __name__ == '__main__':
    N = 0o21254345037435216645726235615257215344466713570721155040602255352100633217547124246572072777535447230201150035166564510401170133623260745110477447001400376547047502533770526363067206734467566514676526512520423464210370410413245572332137014165463407371266747272473730714350752361314510457746412444215732765040414355510317004022041234164355601260476651237006110532370433161624271727511625273561545323113523441440773666656366574473334274735130126450570463402415346646702663632544326172225043671633220243064562344264745412007226743340303326274417761204513627407105114430351521236162077447507432531660744037464630357460267234456020775172276564366731704754404435223065162257442062412532463
    d_ID = 0o6372124242207274553645604216057345425610746731223422163255153336347070066345600060111710430042430265705662715523620546772537361612360210201712555711563753555242513643666051231415720762741157037466124102661330460413555124503477716353225737664604675535735634767255721541343063347476221741112376377442131303271167372411701477654042026230272645222533354453501700700254202010556702342075311437242635772344176021013720764440132325615072647602103565746654026543122715025106714773171056151025715447355467775475645107142660270654032235130267473051340644535073536471022137756672341405301052304054654212025574043075475064345646615135033055510771461402324406303724417403213444364243375364437004
    U = 0o4240647757010421355377061523076674667145117444202511123544563664414701771317661744575111441234741524442632155653607470463010621673140433341562561100711000163411440717174547233054747265260504735525535702133353333102500012735423156656642463702447160737721102214064425310067570420466615013016007515072160463601071013503277075012011231514720126143315022424414471527726471207223052474647746525237106430003627464471755550405320673112766721137125570161733120544663147264055666500641026103545563675214626366537632672052344300320012772700425257336266144624242134672252623260011270236041077106514512034452107223522462416046702733547712466360513276776750305040701745622705112257702702530705536
    V = 0o31603564323222521056463170154702054216070567150024300020463076524401461442106534060161124470423632536436476445056225173137515667472611775166724612722005415557646463701376755352477125256743127165326067054757145164437411043020141532541144450674477530705257645715643027126346544412370262261663312755557015030624346242313625361143155471534742710213526006116225262136216407420116546613561054241320015563604137366133223624750647720412046445105235631077337133005554534732461256372012503052020643621305611267337015011671353002562611231373307672445316524563320125404724735750002074565110550370447471707657655037144666552560306442333264002642737645142277714401262263334040630711177343765122172
    c = U, V
    flag = decrypt(c, d_ID, N)
    print(flag)
